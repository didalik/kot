#!/usr/bin/env bash
#
# Basic integration test (bit) hX qa selftest
#
# Use:
# - hx_ownerPK
# - hx_testnet_IssuerPK
# - hx_STELLAR_NETWORK
# # # # # # # # # # # # #

log () { # {{{1
  local blue=$(git config --get-color color.diff.whitespace "blue")
  local reset=$(git config --get-color "" "reset")
  echo "${blue}$@${reset}"
}

log "$0 started; PWD should be project root: $PWD" # {{{1

read JOBAGENT_SK JOBAGENT_PK < $HOME/.cloudflare-job-fair/CREATOR.keys # {{{1
export JOBAGENT_SK JOBAGENT_PK
read JOBUSER_SK JOBUSER_PK < $HOME/.cloudflare-job-fair/CREATOR.keys
export JOBUSER_SK JOBUSER_PK

bin/run.mjs put_agent $JOBAGENT_PK '*selftest' &
bin/run.mjs post_job $JOBUSER_PK 'hx/selftest' browser=https://kloudoftrust.org/hx
